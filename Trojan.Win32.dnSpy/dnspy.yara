rule dnSpyPlus {
    // Detecting the packed executable 
    meta: 
        last_updated = "2021-02-05"
        author = "An00bRektn"
        description = "A simple yara rule to detect dnSpyPlus.exe"

    strings:
        $PE_magic_byte = "MZ" // only ever shows up as a PE
        $x1 = /dnSpyPlus.*/ // catch all mentions of dnSpyPlus

        // original author was some carbonblackz
        $s1 = /C:\\Users\\carbo.*/ nocase
        $s2 = ".carbon"
        $s3 = "CarbonBlackEncrypt"

    condition:
        $PE_magic_byte at 0 and
        ($x1) and any of ($s*)
}

rule embedded_dnSpyPlus{
    // This rule is intended to detect the modified dnSpy.dll
    meta: 
        last_updated = "2021-02-05"
        author = "An00bRektn"
        description = "A simple yara rule to detect dnSpy.dll"

    strings:
        $PE_magic_byte = "MZ" // only ever shows up as a PE
    
        $dos1 = "!This program cannot be run in DOS mode."

    condition:
        $PE_magic_byte at 0 and
        dnSpyPlus and (2 of ($dos1, $dos1))
}
